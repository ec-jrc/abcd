SRC_DIR = src

CFLAGS += -std=gnu99 -O3 -W -Wall -pedantic -Iinclude/ @IMPLICIT_INCLUDE_DIRECTORIES@ -I@CMAKE_INSTALL_FULL_INCLUDEDIR@/abcd

LIBS = -lm -ljansson -lgsl -lgslcblas
LDFLAGS += @IMPLICIT_LINK_DIRECTORIES@ $(LIBS)

SOURCES = $(wildcard $(SRC_DIR)/*.c)
SHARED_OBJECTS = $(SOURCES:.c=.so)

.PHONY: all clean

all: $(SHARED_OBJECTS)

%.so: %.c
	$(CC) -shared -fPIC $(CFLAGS) $< $(LDFLAGS) -o $@

clean:
	rm -f $(SHARED_OBJECTS)
